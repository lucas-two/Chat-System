<h1>Dashboard</h1>
<h5>Welcome, {{usernameUser}} ({{ statusUser }})!</h5>
<br>

<!-- Admin Tools -->
<!-- Would like to move this into its own page eventually -->


<div>
<!-- Updating user groups and channels -->
  <h5>Manage User Groups & Channels</h5>
  <!-- Groups  -->
  <!-- NOTE: Eventually this will not show groups the user is already in -->
  <div class="card-body">
      <h5 class="card-title">Groups</h5>
      <div class="pull-left">
          <div class="input-group">

            <!-- Display Users -->
            <select class="form-control" [(ngModel)]="selectedUserManageG">
              <option value="" selected disabled hidden>Select User</option>
              <option *ngFor="let user of allUsers">{{ user.username }}</option>
            </select>

            <!-- Display Groups -->
            <select class="form-control" [(ngModel)]="selectedGroupManageG">
              <option value="" selected disabled hidden>Select Group</option>
              <option *ngFor="let group of allGroups">{{ group.groupName }}</option>
            </select>
        </div>
        <br>
        <!-- Buttons to invite / remove from group -->
        <button type="submit" class="btn btn-primary btn-small" (click)="addUserToGroup(selectedUserManageG, selectedGroupManageG)">Invite to Group</button>
        <button type="submit" class="btn btn-danger btn-small" (click)="removeUserFromGroup(selectedUserManageG, selectedGroupManageG)">Remove from Group</button>
      </div>
  </div>


  <!-- Channels -->
  <!-- NOTE: This will eventually be improved such that the groups will only be groups the user is in
  Also it will not show channels the user is already in. -->
  <div class="card-body">
      <h5 class="card-title">Channels</h5>
      <div class="pull-left">
          <div class="input-group">

            <!-- Display Users -->
            <select class="form-control" [(ngModel)]="selectedUserManageC">
              <option value="" selected disabled hidden>Select User</option>
              <option *ngFor="let user of allUsers">{{ user.username }}</option>
            </select>

            <!-- Display Groups -->
            <select class="form-control" [(ngModel)]="selectedGroupManageC">
              <option value="" selected disabled hidden>Select Group</option>
              <option *ngFor="let group of allGroups">{{ group.groupName }}</option>
            </select>

            <!-- Display Channels -->
            <div *ngFor= "let group of allGroups">
                <!-- Get the channels of the selected group -->
              <div *ngIf="group.groupName == selectedGroupManageC">
                <select class="form-control" [(ngModel)]="selectedChannelManageC">
                  <option value="" selected disabled hidden>Select Channel</option>
                  <option *ngFor="let channel of group.channels">{{ channel }}</option>
                </select>
              </div>
          </div>
        </div>
        <br>
        <!-- Buttons to invite / remove from channel -->
        <button type="submit" class="btn btn-primary btn-small" (click)="addUserToChannel(selectedUserManageC, selectedGroupManageC, selectedChannelManageC)">Invite to Channel</button>
        <button type="submit" class="btn btn-danger btn-small" (click)="removeUserFromChannel(selectedUserManageC, selectedGroupManageC, selectedChannelManageC)">Remove from Channel</button>
      </div>
  </div>
  <br>

  <!-- Adding and removing groups & channels -->
  <h5>Manage Groups & Channels</h5>

  <!-- Groups -->
  <div class="card-body">
      <h5 class="card-title">Groups</h5>
      <div class="pull-left">
          <div class="input-group">
            <!-- Input Group -->
            <input class="form-control" placeholder="Enter group name" [(ngModel)]="inputGroupName">
        </div>
        <br>
        <!-- Buttons to invite / remove from group -->
        <button type="submit" class="btn btn-primary btn-small" (click)="createGroup(inputGroupName)" (click)="getAllGroups()">Create Group</button>
        <button type="submit" class="btn btn-danger btn-small">Delete Group</button>
      </div>
  </div>

  <!-- Channels -->
  <div class="card-body">
      <h5 class="card-title">Channels</h5>
      <div class="pull-left">
          <div class="input-group">

            <!-- Display Groups -->
            <select class="form-control" [(ngModel)]="groupOfInputChannel">
              <option value="" selected disabled hidden>Select Group</option>
              <option *ngFor="let group of allGroups">{{ group.groupName }}</option>
            </select>

            <!-- Input Channel -->
            <input class="form-control" placeholder="Enter channel name" [(ngModel)]="inputChannelName">

        </div>
        <br>
        <!-- Buttons to invite / remove from channel -->
        <button type="submit" class="btn btn-primary btn-small" (click)="createChannel(groupOfInputChannel, inputChannelName)">Create Channel</button>
        <button type="submit" class="btn btn-danger btn-small">Delete Channel</button>
      </div>
  </div>
</div>
<br>


<!-- Message board -->

<!-- Groups -->
<h5>Your Groups</h5>
<select class="form-control" [(ngModel)]="selectedGroup">
  <option value="" selected disabled hidden>Select Group</option>
  <option *ngFor="let group of groupsUser">{{ group.groupName }}</option>
</select>
<br>

<!-- Channels -->
<ng-template [ngIf]="hasSlectedGroup()" [ngIfElse]="notSelectedGroup">
  <h5>Your Channels</h5>
    <div *ngFor= "let group of groupsUser">
        <!-- Get the channels of the selected group -->
        <div *ngIf="group.groupName == selectedGroup">
            <select class="form-control" [(ngModel)]="selectedChannel">
                <option value="" selected disabled hidden>Select Channel</option>
                <option *ngFor="let channel of group.channels">{{ channel }}</option>
            </select>
        </div>
      </div>
  </ng-template>
  <br>

  <!-- Display a message if group is not selected -->
  <ng-template #notSelectedGroup>
    <p class="text-muted">Select a group to see your channels.</p>
  </ng-template>

  <div *ngIf="hasSlectedGroup()">
  <ng-template [ngIf]="hasSlectedChannel()" [ngIfElse]="notSelectedChannel">
      <!-- Chat History -->
      <div class="form-group">
          <h5>Chat History</h5>
          <textarea class="form-control" rows="5" disabled></textarea>
        </div>
        <!-- User message input -->
        <div class="pull-left">
            <div class="input-group">
              <input type="text" class="form-control" [(ngModel)]="userText" (keydown.enter)="sendMessage()">
              <button type="submit" class="btn btn-primary btn-small" (click)="sendMessage()">Send</button>
            </div>
        </div>
        <br>
        <!-- Exiting the channel -->
        <button type="submit" class="btn btn-danger btn-small" (click)="exitChannel()">Exit Channel</button>
  </ng-template>
</div>

  <!-- Display a message if channel is not selected -->
  <ng-template #notSelectedChannel>
      <p class="text-muted">Select a channel to enter chat room.</p>
  </ng-template>




